

const A_unshift=(e,t)=>{let s=e.length;for(;s;)e[s]=e[s-1],--s;e[0]=t},A_splice=(e,t)=>{let s=e.length;if(s){for(;t<s;)e[t]=e[t+1],++t;--e.length}},A_indexOf=(e,t)=>{for(let s=0,a=e.length;s!=a;s++)if(e[s]===t)return s;return-1},A_lastIndexOf=(e,t)=>{let s=e.length;for(;s--&&e[s]!==t;);return s},A_fill=(e,t)=>{const s=new Array(e);for(;--e>=0;)s[e]=t;return s},DOM_setRootVar=(e,t)=>{document.documentElement.style.setProperty(e,t)},DOM_getRootVar=e=>getComputedStyle(document.documentElement).getPropertyValue(e)||"";function DOM_resetNode(e){for(var t=document.getElementById(e);t.firstChild;)t.removeChild(t.firstChild)}const DOM_getStyle=(e,t)=>{let s=document.getElementById(e);return s?window.getComputedStyle(s).getPropertyValue(t):""},DOM_getImgDim=e=>{const t=document.getElementById(e);return{width:t.getAttribute("data-src-width"),height:t.getAttribute("data-src-height")}},DOM_strimHTML=e=>e.replace(/(<([^>]+)>)/gi,""),DOM_openFolder=e=>{e.nextElementSibling.classList.toggle("ca_is_open"),e.parentElement.classList.toggle("ca_has_open")},DOM_openFolderAll=()=>{const e=document.getElementById("ca_folder_container_inner").querySelectorAll(".ca_folder");for(let t of e)DOM_openFolder(t)},DOM_dialog=(e,t)=>{const s=e.type;if(dialog_e=document.getElementById(`ca_${s}_dialog`),t||"function"!=typeof dialog_e.showModal){const t=e.mark?DOM_strimHTML(e.mark):"";return void window.alert(`${e.header||""}: ${e.content||""} (${t})`)}if(e.header&&(document.getElementById(`ca_${s}_dialog_header`).innerHTML=e.header),e.content&&(document.getElementById(`ca_${s}_dialog_text`).innerHTML=e.content+(e.mark?e.mark:"")),void 0===e.options_a){const e=document.getElementById(`ca_${s}_dialog_options`);e&&e.classList.add("ca_dialog_option_hidden")}else{document.getElementById(`ca_${s}_dialog_options`).classList.remove("ca_dialog_option_hidden");const t=document.getElementById(`ca_${s}_dialog_options`).querySelectorAll("li");for(let s=0;s<t.length;++s){const a=t[s].classList.contains("ca_dialog_option_hidden");e.options_a[s]?(t[s].innerHTML=e.options_a[s],t[s].classList.remove("ca_dialog_option_hidden"),t[s].addEventListener("click",()=>{console.log(e.options_a[s])})):a||t[s].classList.add("ca_dialog_option_hidden")}}const a=e.cancel||"cancelled";document.getElementById(`ca_${s}_dialog_close`).addEventListener("click",()=>{console.log(`type: ${e.type}`),dialog_e.close(a)}),dialog_e.addEventListener("click",e=>{e.target===dialog_e&&dialog_e.close(a)}),dialog_e.addEventListener("close",t=>{e.result=dialog_e.returnValue}),dialog_e.showModal()},DOM_toClipboard=e=>{const t=()=>{e.mark+=" impossible",DOM_dialog(e,!0)};navigator.permissions.query({name:"clipboard-write"}).then(s=>{"granted"!=s.state&&"prompt"!=s.state||navigator.clipboard.writeText(e.content).then(()=>{DOM_dialog(e)},()=>{t()})}).catch(()=>{t()})},EMAddressToClip=()=>{const e={type:"note",header:"Adresse pour me contacter",content:((e,t)=>{const s=e=>String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+13)?e:e-26);return`${e.replace(/[a-zA-Z]/g,s)}@${t.replace(/[a-zA-Z]/g,s)}`})("nqhcva","purepurheq.neg"),mark:'<mark class="ca_note_dialog_text_mark">copie dans le presse-papier</mark>'};DOM_toClipboard(e)},statusDialog=()=>{DOM_dialog({type:"status"})},searchTagsDialog=()=>{DOM_dialog({type:"search"})};class DragElement{constructor(e,t){this.gapX=0,this.gapY=0,this.offsetX=0,this.offsetY=0,this.atX=0,this.atY=0,this.drag_e=e,this.keep_b=t||!1,this.start()}start(){this.drag_e.onmousedown=(e=>(this.loose=!1,this.gapX=e.clientX-this.offsetX,this.gapY=e.clientY-this.offsetY,this.drag_e.addEventListener("mousemove",this,!1),this.drag_e.addEventListener("mouseup",this,!1),!1))}disable(){this.loose=!0}handleEvent(e){return!this.loose&&("mousemove"===e.type?(this.atX=e.clientX-this.gapX,this.atY=e.clientY-this.gapY,this.offsetX=this.atX,this.offsetY=this.atY,this.drag_e.style.transform=`translate3d(${this.atX}px, ${this.atY}px, 0)`,!1):void("mouseup"===e.type&&(this.keep_b||(this.drag_e.removeEventListener("mousemove",this,!0),this.drag_e.removeEventListener("mouseup",this,!0)),this.loose=!0)))}}const RGB_H=(e,t,s)=>{const a=Math.min(e,t,s),r=Math.max(e,t,s);if(r===a)return 0;const o=r-a,n=r===e?(t-s)/o+(t<s?6:0):r===t?(s-e)/o+2:(e-t)/o+4;return Math.floor(60*n)},RGB_S=(e,t,s)=>{const a=Math.min(e,t,s),r=Math.max(e,t,s),o=r-a;if(!o)return 0;const n=a+r;return n>255?o/(510-r-a):o/n},RGB_L=(e,t,s)=>(Math.min(e,t,s)+Math.max(e,t,s))/510,HSL_RGB=(e,t,s)=>{let a,r,o;if(0===t)a=r=o=s;else{const n=(e,t,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<.1666667?e+6*(t-e)*s:s<.5?t:s<.6666667?e+(t-e)*(.6666667-s)*6:e),i=s<.5?s*(1+t):s+t-s*t,l=2*s-i;a=n(l,i,(e/=360)+.3333334),r=n(l,i,e),o=n(l,i,e-.3333334)}return[a,r,o]},H_toMatrix=e=>{let t,s,a,r=DOM_getRootVar("--M3_FE_MATRIX");return e<0?t=s=a=DOM_getRootVar("--M3_FE_MATRIX_GRAY_VALUE"):(rgb_a=HSL_RGB(e,1,.5),t=rgb_a[0]+.5,s=rgb_a[1]+.5,a=rgb_a[2]+.5),r=r.replace("R",t).replace("G",s).replace("B",a)};class DOM_FeColorMatrix{constructor(e,t,s){this._animateID=t||"ca_animate",this._filter_e=document.getElementById(e),this.createMatrix(s)}toMatrix(e){return{from_s:`${e.r0} 0 0 0 0    0 ${e.g0} 0 0 0    0 0 ${e.b0} 0 0    0 0 0 1 0`,to_s:`${e.r1} 0 0 0 0    0 ${e.g1} 0 0 0    0 0 ${e.b1} 0 0    0 0 0 1 0`}}toBegin(e,t){let s=void 0!==t?`${t}s;`:"";return void 0!==e&&(s+=`${e}.end`),s}toDuration(e){return`${e.d}s`}createAnimate(e,t){const s=document.createElementNS("http://www.w3.org/2000/svg","animate");let a,r;return s.setAttribute("id",`${this._animateID}_${e}`),s.setAttribute("attributeType","XML"),s.setAttribute("attributeName","values"),s.setAttribute("dur",this.toDuration(t)),s.setAttribute("repeatCount",1),({from_s:a,to_s:r}=this.toMatrix(t)),s.setAttribute("from",a),s.setAttribute("to",r),s}createMatrix(e){const t=e.length-1;for(let s=0;s<=t;++s){const a=this.createAnimate(s,e[s]),r=0===s?this.toBegin(`${this._animateID}_${t}`,0):this.toBegin(`${this._animateID}_${s-1}`);a.setAttribute("begin",r),this._filter_e.appendChild(a)}}}class LogScale{constructor(e){this.minpos=e.minpos||0,this.minlval=Math.log(e.minval||1),this.maxlval=Math.log(e.maxval||1e5),this.scale=(this.maxlval-this.minlval)/(e.maxpos-this.minpos)}getPosition(e){return this.minpos+(Math.log(e)-this.minlval)/this.scale}}const AreaInput=e=>{const t=null!==document.querySelector(".ca_area_perspective");document.getElementById("ca_content").classList.toggle("ca_content_perspective");const s=document.getElementsByClassName("ca_area"),a=document.getElementsByClassName("ca_area_selector"),r=a.length;for(let e=0;e<r;++e)s.item(e).classList.toggle("ca_area_perspective"),a.item(e).classList.toggle("ca_selector_perspective");t?document.getElementById(e.replace("select_","")).classList.toggle("ca_area_active"):document.querySelector(".ca_area_active").classList.toggle("ca_area_active")},ScrollLevel=e=>{document.getElementById("ca_grad_down_empty").setAttribute("offset",`${e}%`),document.getElementById("ca_grad_down_fill").setAttribute("offset",`${e}%`),e=100-e,document.getElementById("ca_grad_up_empty").setAttribute("offset",`${e}%`),document.getElementById("ca_grad_up_fill").setAttribute("offset",`${e}%`)},ScrollPosition=e=>{const t=document.body.scrollHeight-window.innerHeight||1;ScrollLevel(Math.floor(e/t*100))},ScrollPage=e=>{const t={left:0,top:window.innerHeight*e,behavior:"smooth"};window.scrollBy(t),ScrollPosition(window.pageYOffset)};window.addEventListener("scroll",e=>{ScrollPosition(window.pageYOffset)});const SearchSettings_o={tags:["XXX","PER","ART","WORK","COL","BIB","WEB"],titles:["SANS FILTRE","NOM DE PERSONNE","NOM D'ARTISTE","ŒUVRE D'ART","COLLECTION","BIBLIOGRAPHIE","TECHNOLOGIE"],need_s:"",tag_n:0,tag_s:""},fromProvider=e=>{const t=e.result;searchOutputEntries(t?t.length?t:"NOT_FOUND":"RESET"),"RETRIEVE"===e.task_s&&(SearchSettings_o.need_s=t[0].need_s,SearchSettings_o.tag_s=t[0].tag_s,searchUpdateRequest())};var searchWorker_p;(()=>{const e=new SharedWorker(`${SITE_ROOT_URL}static/scripts/search_w.js`);(searchWorker_p=e.port).onmessageerror=(e=>console.log(`CLIENT ERROR: ${e.message}`)),searchWorker_p.onmessage=(e=>{fromProvider(e.data)}),searchWorker_p.start(),searchWorker_p.postMessage({task_s:"INIT",url_s:`${SITE_ROOT_URL}search.ini`}),searchWorker_p.postMessage({task_s:"RETRIEVE"})})();const searchOutputEntries=e=>{const t=document.getElementById("ca_search_list");for(;t.firstChild;)t.removeChild(t.firstChild);let s,a,r,o,n,i,l,c,_,d;if("string"==typeof e){if("RESET"===e)return;return s=document.getElementById("ca_search_result_entry_void"),r=(a=document.importNode(s.content,!0)).querySelectorAll("dt"),o="NOT_FOUND"===e?"Auncun résultat n'a été trouvé. Essayez avec un autre filtre.":"Le terme fourni pour la recherche est invalide!",r[0].textContent=o,void t.appendChild(a)}s=document.getElementById("ca_search_result_entry");let g=-1;for(entry_o in e)++g,n=(a=document.importNode(s.content,!0)).querySelectorAll("div.ca_urlentry"),e[entry_o].visited&&n[0].classList.toggle("ca_urlentry_mark"),i=a.querySelectorAll("dl"),(c=a.querySelectorAll("a"))[0].setAttribute("href",`${SITE_ROOT_URL}${e[entry_o].path_s}.html`),c[0].setAttribute("data-entry",`${g}`),c[0].setAttribute("onclick","searchVisit( this )"),c[0].textContent=e[entry_o].title_s,(l=a.querySelectorAll("dt"))[0].appendChild(c[0]),i[0].appendChild(l[0]),(_=a.querySelectorAll("dd"))[0].textContent=e[entry_o].date_s+" ",(d=document.createElement("em")).textContent=e[entry_o].author_s,_[0].appendChild(d),i[0].appendChild(_[0]),_[1].textContent=e[entry_o].abstract_s,i[0].appendChild(_[1]),n[0].appendChild(i[0]),t.appendChild(n[0])},searchUpdateRequest=()=>{searchSetMarks(),searchSetNeedForm();const e=SearchSettings_o.tags.findIndex(e=>e===SearchSettings_o.tag_s);searchSetTagForm(e)},searchSetNeedForm=e=>document.getElementById("ca_search_text").value=SearchSettings_o.need_s,searchSetTagForm=e=>document.getElementById("ca_inputbox_label_tag").innerHTML=SearchSettings_o.titles[e],searchSetTag=e=>{SearchSettings_o.tag_n=e,searchSetTagForm(e)},searchSubmit=()=>{const e=document.getElementById("ca_search_text").value.replace(/[^a-zA_Z\d\s&'\-]/gi,"");if(0===e.length)return searchOutputEntries("BAD_ENTRY");const t=SearchSettings_o.tags[SearchSettings_o.tag_n];searchWorker_p.postMessage({task_s:"SEARCH",need_s:e,tag_s:t})},searchVisit=e=>{searchWorker_p.postMessage({task_s:"VISIT_URL",entry:e.getAttribute("data-entry")});let t=e.parentNode;for(;t&&!t.classList.contains("ca_urlentry");)t=t.parentNode;t.classList.toggle("ca_urlentry_mark")},searchReset=()=>{searchSetMarks(),searchOutputEntries("RESET"),SearchSettings_o.need_s="",SearchSettings_o.tag_s="",searchWorker_p.postMessage({task_s:"RESET"})},searchPrevious=()=>searchWorker_p.postMessage({task_s:"PREVIOUS"}),searchNext=()=>searchWorker_p.postMessage({task_s:"NEXT"}),searchSetMarks=()=>{const e=SearchSettings_o.need_s;document.querySelectorAll(`mark[data-tag="${SearchSettings_o.tag_s}"]`).forEach(t=>{t.innerText.indexOf(e)>-1&&t.classList.toggle("ca_mark_highlight")})};

