
const IMG_PROCESS_o={slider_o:{top_n:0,uni_n:2,uniheight_n:32}};class ColorScan{constructor(e){this._imageId=e.imageId,this._canvasId=e.canvasId,this._hue_n=e.hue_n,this._lum_n=e.lum_n,this._type=e.type||"JPEG",this._canvas=null,this._image=null,this._context=null,this._imageData=null,this._data=null,this._capacity=0,this._display=null,this._hue_a=null,this._lum_a=null,this._hueCount_a=null,this._hueCountMax=0,this._lumCountMax_n=0,this.init()}init(){try{this._canvas=document.getElementById(this._canvasId),this._image=document.getElementById(this._imageId),this._canvas.width=this._image.width,this._canvas.height=this._image.height,this._display=this._canvas.style.display,this._context=this._canvas.getContext("2d"),this._context.drawImage(this._image,0,0),this._imageData=this._context.getImageData(0,0,this._image.width,this._image.height),this._data=this._imageData.data,this._capacity=this._data.length>>2,this._hue_a=new Array(this._hue_n);for(let e=0;e<this._hue_n;++e)this._hue_a[e]=[];this._lum_a=new Array(this._lum_n);for(let e=0;e<this._lum_n;++e)this._lum_a[e]=[]}catch(e){console.log(`[class ColorScan] init method error: ${e}`)}return this}scan(){try{console.time("scanM");const e=this._data.length;let t,_,i;for(let s=0;s<e;s+=4)t=this._data[s],_=this._data[s+1],i=this._data[s+2],this._hue_a[RGB_H__n(t,_,i)].push(s),this._lum_a[Math.floor(100*RGB_L__n(t,_,i))].push(s);return console.timeEnd("scanM"),this}catch(e){console.log(`[class ColorScan]init method error: ${e} -- at = ${at}`)}}getHue_a(){return this._hue_a}getHueCount_a(){if(null===this._hueCount_a){this._hueCount_a=new Array(this._hue_n);let e;for(let t=0;t<this._hue_n;++t)e=this._hue_a[t].length,this._hueCount_a[t]=e,e>this._hueCountMax&&(this._hueCountMax=e)}return this._hueCount_a}getHueCountMax(){return null===this._hueCount_a&&this.getHueCount_a(),this._hueCountMax}getHue_n(){return this._hue_n}getCapacity_n(){return this._capacity}getCanvasWidth(){return this._canvas.width}HSL_RGBA_a(e,t,_){const i=Math.floor(t*_)*this._canvas.width*4+4*Math.floor(e*_);return{r:this._data[i],g:this._data[i+1],b:this._data[i+2],a:this._data[i+3]}}HSL_HSLA_a(e,t,_){let i,s,a,o;return({r:i,g:s,b:a,a:o}=this.HSL_RGBA_a(e,t,_)),{h:RGB_H__n(i,s,a),s:RGB_S__n(i,s,a),l:RGB_L__n(i,s,a),a:o}}getSaturLumen_a(e){const t=new Int32Array(101),_=new Int32Array(101);let i=this._hue_a[e].length;for(let s=0;s<i;++s){const i=this._hue_a[e][s],a=this._data[i],o=this._data[i+1],n=this._data[i+2];t[Math.floor(100*RGB_S__n(a,o,n))]+=1,_[Math.floor(100*RGB_L__n(a,o,n))]+=1}return[t,_]}setDisplay(e){return e?(this._context.putImageData(this._imageData,0,0),this.display="inline"):this.display="none",this._canvas.style.display=this.display,this}setOpacity(e,t,_){let i;if(0===e){i=this._hue_a[t].length;for(let e=0;e<i;++e)this._data[this._hue_a[t][e]+3]=_}else{i=this._lum_a[t].length;for(let e=0;e<i;++e)this._data[this._lum_a[t][e]+3]=_}return this}}class ColorConsole{constructor(e){const t="hue"===e.mode?360:100;this._selectorId=e.selectorId,this._eqInputId=e.eqInputId,this._slidersId=e.slidersId,this._slideId=e.slideId,this._slider_n=e.slider_n,this._mode=e.mode,this._arcWidth=t/this._slider_n,this._slideWidth=Math.floor(.92*window.innerWidth/this._slider_n),this._consoleWidth=this._slider_n*this._slideWidth,this._gridColor=e.gridColor||DOMRootVar__s("--M3_CONSOLE_COLOR"),this._handle=e.handle,this._loose=!1,this._lastHit=0,this._paint=null,this._sliders_a=[],this._levels_a=[],DOMRootVar("--M3_CONSOLE_WIDTH",this._consoleWidth),this.init()}init(){this._paint=SVG(this._selectorId).size(this._consoleWidth,CA_media_o.SLIDE_RANGE+IMG_PROCESS_o.slider_o.uniheight_n*IMG_PROCESS_o.slider_o.uni_n).attr("id",this._slidersId).addClass(this._slidersId).group(),this.drawColors(),this.drawSliders(),this.drawGaps();return this.setSlider({arc:0,eq:!0,level:0}),this._svg_el=document.getElementById(this._slidersId),this._svg_el.onmousedown=(e=>(this._loose=!1,this._svg_el.addEventListener("mousemove",this,!1),this._svg_el.addEventListener("mouseup",this,!1),this.handleEvent(e),!1)),this}drawColors(){const e=100/this._slider_n*.01,t=this._slider_n,_=this._arcWidth;let i;return i="hue"===this._mode?this._paint.gradient("linear",function(i){for(var s=0;s<=t;++s)i.at(e*s,`hsla(${_*s}, 100%, 50%, 1.0)`)}):this._paint.gradient("linear",function(i){for(var s=0;s<=t;++s)i.at(e*s,`hsla(0, 0%, ${_*s}%, 1.0)`)}),this._paint.rect(this._consoleWidth,CA_media_o.SLIDE_RANGE+IMG_PROCESS_o.slider_o.uniheight_n*IMG_PROCESS_o.slider_o.uni_n).fill(i),this}drawSliders(){const e=DOMRootVar__s("--M3_CONSOLE_COLOR"),t=DOMRootVar__s("--M3_CONSOLE_COLOR");let _,i,s;for(_=i=s=0;_<this._slider_n;++_)this._sliders_a[_]={slider:null,cursor:null},this._sliders_a[_].slider=this._paint.rect(this._slideWidth,CA_media_o.SLIDE_RANGE).fill({color:e,opacity:1}).move(s,IMG_PROCESS_o.slider_o.top_n),this._sliders_a[_].cursor=this._paint.line(_*this._slideWidth,IMG_PROCESS_o.slider_o.top_n,_*this._slideWidth+this._slideWidth-2,IMG_PROCESS_o.slider_o.top_n).stroke({color:t,width:4}),i+=this._arcWidth,s+=this._slideWidth;return this}drawGaps(){const e={color:this._gridColor,width:4};let t=this._consoleWidth;for(let _=0,i=CA_media_o.SLIDE_RANGE-1;_<IMG_PROCESS_o.slider_o.uni_n;++_,i+=IMG_PROCESS_o.slider_o.uniheight_n)this._paint.line(0,i,t,i).stroke(e);return this}handleEvent(e){if(this._loose)return!1;if("mouseup"===e.type)return this._loose=!0,this._svg_el.removeEventListener("mousemove",this,!0),this._svg_el.removeEventListener("mouseup",this,!0),!1;if("mousedown"===e.type||"mousemove"===e.type){let t=this._svg_el.getBoundingClientRect();const _=e.clientX-t.left,i=e.clientY-t.top;this._lastHit=Math.floor(_/this._slideWidth);const s={arc:this._lastHit,slider_n:this._slider_n,eq:"1"===document.getElementById(this._eqInputId).value,level:0};i<CA_media_o.SLIDE_RANGE?s.level=Math.floor(i):i>CA_media_o.SLIDE_RANGE+2*IMG_PROCESS_o.slider_o.uniheight_n?s.level=-1:i>CA_media_o.SLIDE_RANGE+IMG_PROCESS_o.slider_o.uniheight_n&&(s.level=CA_media_o.SLIDE_RANGE),this.setSlider(s),this._handle(s)}}setSlider(e){let t=0,_=this._slider_n;for(!1===e.eq&&(t=e.arc,_=e.arc+1);t<_;++t)this._sliders_a[t].slider.opacity(e.level/CA_media_o.SLIDE_RANGE),this._sliders_a[t].cursor.move(t*this._slideWidth,IMG_PROCESS_o.slider_o.top_n+e.level),this._levels_a[t]=e.level}getSlideWidth(){return this._slideWidth}setHit(e){this._lastHit=e}}class ColorBurst{constructor(e){this._svgId=e.svgId,this._colors=e.colors,this._max=e.max,this._onHueChange=e.onHueChange||null,this._onHueTrace=e.onHueTrace||null,this._svg_el=document.getElementById(this._svgId),e.onHueChange&&this._svg_el.addEventListener("click",this,!1),e.onHueTrace&&this._svg_el.addEventListener("mousemove",this,!1)}getCoords(e,t){const _=MAIN_o.math.pi2_n*e;return[Math.cos(_)*t,Math.sin(_)*t]}draw(e){const t=(e||1)/this._colors.length,_=new LogScale({minpos:0,maxpos:100,minval:0,maxval:this._max});let i=0;this._colors.forEach(e=>{if(e){const s=_.position__n(e.frequency),[a,o]=this.getCoords(i,s);i+=t;const[n,l]=this.getCoords(i,s),r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",`M ${a} ${o} A 1 1 0 0 1 ${n} ${l} L 0 0`),r.setAttribute("fill",e.hsl),this._svg_el.appendChild(r)}else i+=t;0})}handleEvent(e){if("mousemove"===e.type||"click"===e.type){let t=this._svg_el.getBoundingClientRect();const _=e.clientX-(t.left+t.width/2),i=e.clientY-(t.top+t.height/2);let s=Math.atan2(i,_)*MAIN_o.math.radDeg_n;return s<0&&(s+=360),this.atHue=Math.floor((s+90)%360),"mousemove"===e.type&&this._onHueTrace?this._onHueTrace(this.atHue):this._onHueChange&&this._onHueChange(this.atHue),!1}}}class AnimationFrames{constructor(e,t,_){this._frames_a=[],this._imgWidth=e,this._imgHeight=t,this.init(_)}init(e){const t=this._imgWidth/2;let _=t;const i=this._imgHeight/2;let s,a,o=i,n=0,l=0;for(let r=0;r<e.length;++r){this._frames_a[r]={offset:e[r].o/100},e[r].p&&(this._frames_a[r].opacity=e[r].p);let c="";e[r].s&&(c+=`scale(${e[r].s})`),e[r].t&&(n=e[r].t[0],a=-((l=e[r].t[1])-i),((s=-(n-t))||a)&&(c+=` translate(${s}px, ${a}px)`,_=n,o=l)),""!==c&&(this._frames_a[r].transform=c)}}getFrames(){return this._frames_a}}class OverlaySplitter{constructor(e){this._splitter_e=document.getElementById(e.splitterID),this._front_e=document.getElementById(e.frontID),this._clipClass=e.clipClass,this._clipVar=e.clipVar,this._isOn=!1}start(){this._front_e.classList.toggle(this._clipClass),this.clip(),this._splitter_e.addEventListener("click",this,!1)}pause(){this._splitter_e.removeEventListener("mousemove",this,!1)}stop(){this.pause(),this._front_e.classList.toggle(this._clipClass)}clip(e){const t=+window.getComputedStyle(this._front_e).width.replace("px","");void 0===e&&(e=.5*t),DOMRootVar(this._clipVar,`${t-e}px`)}handleEvent(e){if("click"===e.type)return this._isOn?(this._isOn=!1,void this.pause()):(this._isOn=!0,void this._splitter_e.addEventListener("mousemove",this,!1));"mousemove"===e.type&&this._isOn&&this.clip(e.clientX)}}var CA_media_o={M_img_e:null,M1_input__v:null,M2_input_f:null,M3_input_f:null,M3_scan_i:null,SLIDE_RANGE:256};const M1_process=()=>{try{let e=null,t=null,_=null,i=!0,s=document.getElementById("ca_media_1_img"),a=document.getElementById("ca_media_1_control_play_pause").querySelectorAll(".ca_layout_switch"),o=document.getElementById("ca_media_1_control_drag_stop").querySelectorAll(".ca_layout_switch"),n=document.getElementById("ca_media_1_processor_anim");const l=()=>{null===e&&(e=new DragElement(s)),e.start(),DOMRootVar("--M1_CURSOR","move")},r=()=>{null===t?p():t.play(),m(),v()&&u()},c=()=>{t.pause(),m()},d=()=>{t.cancel(),E()||m(),u(),g()},h=()=>{let e=t.playbackRate;e=e<8?e+.25:.25,t.playbackRate=e},m=()=>{a[0].classList.toggle("ca_layout_switch_active"),a[1].classList.toggle("ca_layout_switch_active")},u=()=>{o[0].classList.toggle("ca_layout_switch_active"),o[1].classList.toggle("ca_layout_switch_active")},g=()=>{s.style.setProperty("opacity","1"),s.style.setProperty("transform","scale( 1 )"),n.style.setProperty("clip-path","inset(0px 0px)")},p=()=>{if(!M1_frames_a||!s||!n)return;let e,i,a=.1*Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=.1*Math.max(document.documentElement.clientHeight,window.innerHeight||0);({width:e,height:i}=DOMImgDim__o("ca_media_1_img")),n.style.setProperty("clip-path",`inset(${o}px ${a}px)`),_=new AnimationFrames(e,i,M1_frames_a),(t=s.animate(_.getFrames(),M1_anim_o)).playbackRate=1},E=()=>a[0].classList.contains("ca_layout_switch_active"),v=()=>o[0].classList.contains("ca_layout_switch_active");CA_media_o.M1_input__v=(e=>{switch(e){case"PLAY_PAUSE":E()?(r(),DOMRootVar("--M1_CURSOR","auto")):c();break;case"DRAG_STOP":v()?l():d();break;case"FAST_BACKWARD":if(null===t)break;i&&(t.reverse(),i=!1),h();break;case"FAST_FORWARD":if(null===t)break;i||(t.reverse(),i=!0),h()}}),document.getElementById("ca_media_1_control_pad").addEventListener("click",e=>{const t=e.target.closest(".ca_media_control_key");return"ca_media_1_control_play_pause"===t.id?CA_media_o.M1_input__v("PLAY_PAUSE"):"ca_media_1_control_drag_stop"===t.id?CA_media_o.M1_input__v("DRAG_STOP"):"ca_media_1_control_forward"===t.id?CA_media_o.M1_input__v("FAST_FORWARD"):"ca_media_1_control_backward"===t.id?CA_media_o.M1_input__v("FAST_BACKWARD"):void 0})}catch(e){console.log(`ERROR DETECTED @M1_process: ${e}`)}},M2_process=()=>{try{document.getElementById("ca_media_2_img");let e,t;({width:e,height:t}=DOMImgDim__o("ca_media_2_img")),DOMRootVar("--MEDIA_PROCESSOR_DIM",e<t?"75vmin":"90vmin");const _=e/4,i=_,s=t/4,a=s,o="http://www.w3.org/2000/svg";let n;const l=document.getElementById("ca_media_2_processor_lines");l.setAttribute("viewBox",`0 0 ${e} ${t}`);const r=document.createElementNS(o,"g");for(r.setAttribute("id","ca_media_2_lines_v"),n=i;n<e;n+=_){const e=document.createElementNS(o,"line");e.setAttribute("x1",`${n}`),e.setAttribute("y1","0"),e.setAttribute("x2",`${n}`),e.setAttribute("y2",`${t}`),r.appendChild(e)}l.appendChild(r);const c=document.createElementNS(o,"g");for(c.setAttribute("id","ca_media_2_lines_hz"),n=a;n<t;n+=s){const t=document.createElementNS(o,"line");t.setAttribute("x1","0"),t.setAttribute("y1",`${n}`),t.setAttribute("x2",`${e}`),t.setAttribute("y2",`${n}`),c.appendChild(t)}l.appendChild(c);const d=document.createElementNS(o,"line");d.setAttribute("id","ca_media_2_lines_lr"),d.setAttribute("x1","0"),d.setAttribute("y1","0"),d.setAttribute("x2",`${e}`),d.setAttribute("y2",`${t}`),l.appendChild(d);const h=document.createElementNS(o,"line");h.setAttribute("id","ca_media_2_lines_rl"),h.setAttribute("x1",`${e}`),h.setAttribute("y1","0"),h.setAttribute("x2","0"),h.setAttribute("y2",`${t}`),l.appendChild(h);let m=0,u=0;CA_media_o.M2_input_f=(e=>{let t;switch(e){case"UNDO":return m=0,void(u=0);case"lines_v":case"lines_hz":case"lines_lr":case"lines_rl":{const t=document.getElementById(`ca_media_2_${e}`);return void(t.style.opacity="0"===t.style.opacity?"1":"0")}case"ROTATE_CW":m+=90,t=`rotate(${m%=360}deg)`;break;case"ROTATE_CW_R":m-=90,t=`rotate(${m%=360}deg)`;break;case"FLIP_CW":u+=180,t=`rotateY(${u%=360}deg)`;break;case"FLIP_CW_R":u+=180,t=`rotateX(${u%=360}deg)`}t&&(document.getElementById("ca_media_2_processor").style.transform=t)}),document.getElementById("ca_media_2_control_pad").addEventListener("click",e=>{const t=e.target.closest(".ca_media_control_key");return"ca_media_2_control_rotate_cw"===t.id?CA_media_o.M2_input_f("ROTATE_CW"):"ca_media_2_control_lines_v"===t.id?CA_media_o.M2_input_f("lines_v"):"ca_media_2_control_rotate_cw_r"===t.id?CA_media_o.M2_input_f("ROTATE_CW_R"):"ca_media_2_control_lines_lr"===t.id?CA_media_o.M2_input_f("lines_lr"):"ca_media_2_control_undo"===t.id?CA_media_o.M2_input_f("UNDO"):"ca_media_2_control_lines_rl"===t.id?CA_media_o.M2_input_f("lines_rl"):"ca_media_2_control_flip_cw"===t.id?CA_media_o.M2_input_f("FLIP_CW"):"ca_media_2_control_lines_hz"===t.id?CA_media_o.M2_input_f("lines_hz"):"ca_media_2_control_flip_cw_r"===t.id?CA_media_o.M2_input_f("FLIP_CW_R"):void 0})}catch(e){console.log(`ERROR DETECTED @M2_process: ${e}`)}},M3_process=()=>{try{const e=360,t=101,_=e=>{e?u.start():u.stop()},i=()=>{document.getElementById("ca_media_3_color_selector").classList.toggle("ca_media_3_color_selector_mute")},s=e=>{i();const t=document.getElementById("ca_media_3_processor_canvas");t.classList.toggle("ca_media_3_color_picker"),document.getElementById("ca_media_3_processor_trace").classList.toggle("ca_color_trace_show"),e?(t.addEventListener("click",l,!1),t.addEventListener("mousemove",n,!1)):(t.removeEventListener("click",l,!1),t.removeEventListener("mousemove",n,!1))},a=e=>{const t=DOMStyle__s("ca_media_3_processor_canvas","width").replace("px",""),_=CA_media_o.M3_scan_i.getCanvasWidth();return CA_media_o.M3_scan_i.HSL_RGBA_a(e.clientX,e.clientY,_/t)},o=e=>{const t=DOMStyle__s("ca_media_3_processor_canvas","width").replace("px",""),_=CA_media_o.M3_scan_i.getCanvasWidth();return CA_media_o.M3_scan_i.HSL_HSLA_a(e.clientX,e.clientY,_/t)},n=e=>{let t,_,i,s;({h:t,s:_,l:i,a:s}=o(e)),document.getElementById("ca_media_3_processor_trace_H_v").innerHTML=t,document.getElementById("ca_media_3_processor_trace_S_v").innerHTML=Math.floor(100*_),document.getElementById("ca_media_3_processor_trace_L_v").innerHTML=Math.floor(100*i),document.getElementById("ca_media_3_processor_trace_A_v").innerHTML=Math.floor(s/255*100)},l=e=>{let t,_,i,o;({r:t,g:_,b:i,a:o}=a(e)),h.setHit(RGB_H__n(t,_,i)),s(!1)};CA_media_o.M3_input_f=(e=>{const t=document.getElementById(e.getAttribute("for")),i=t.getAttribute("type"),a="1"===t.value?"0":"1";if("radio"===i){if("0"===a)return;document.querySelector('.ca_media_3_pad_input_radio[value="1"]').value="0",document.querySelector('.ca_media_3_pad_label[value="1"]').setAttribute("value","0")}t.value=a,e.setAttribute("value",a);let o=DOMRootVar__s("--M3_FE_MATRIX_RESET");switch(e.id){case"ca_media_3_split_label":return void _("1"===a);case"ca_media_3_hue_label":case"ca_media_3_lum_label":{document.getElementById("ca_media_3_selector_hue_console").classList.toggle("ca_color_selector_console_active"),document.getElementById("ca_media_3_selector_lum_console").classList.toggle("ca_color_selector_console_active");const t="ca_media_3_hue_label"===e.id?h.getSlideWidth():m.getSlideWidth();return void DOMRootVar("--M3_SLIDE_WIDTH",t)}case"ca_media_3_tone_label":"1"===a&&(o=HueMatrix__s(h._lastHit));break;case"ca_media_3_gray_label":"1"===a&&(o=HueMatrix__s(-1));break;case"ca_media_3_pick_label":s(!0);break;default:return}document.getElementById("ca_media_3_filter_matrix").setAttribute("values",o)});const r=e=>{CA_media_o.M3_scan_i.setDisplay();const t="1"===document.getElementById("ca_media_3_hue_input").value?0:1;if(e.eq){if(e.level>=0){const _=e.slider_n;for(let i=0;i<_;++i)CA_media_o.M3_scan_i.setOpacity(t,i,CA_media_o.SLIDE_RANGE-1-e.level)}}else e.level>=0&&CA_media_o.M3_scan_i.setOpacity(t,e.arc,CA_media_o.SLIDE_RANGE-1-e.level);CA_media_o.M3_scan_i.setDisplay("inline")},c=e=>{const t=e.clientX-document.getElementById("ca_media_3_selector_hue_console").getBoundingClientRect().left,_=DOMRootVar__s("--M3_SLIDE_WIDTH");document.getElementById("ca_media_3_trace_label").innerHTML=`${Math.floor(t/_)}`},d={canvasId:"ca_media_3_processor_canvas",imageId:"ca_media_3_img",hue_n:e,lum_n:t};CA_media_o.M3_scan_i=new ColorScan(d),CA_media_o.M3_scan_i.setDisplay("inline").scan();const h=new ColorConsole({mode:"hue",selectorId:"ca_media_3_selector_hue_console",eqInputId:"ca_media_3_uni_input",slidersId:"ca_media_3_selector_hue_sliders",slideId:"ca_media_3_selector_slide",handle:r,slider_n:e});DOMRootVar("--M3_SLIDE_WIDTH",h.getSlideWidth());const m=new ColorConsole({mode:"lum",selectorId:"ca_media_3_selector_lum_console",eqInputId:"ca_media_3_uni_input",slidersId:"ca_media_3_selector_lum_sliders",slideId:"ca_media_3_selector_slide",handle:r,slider_n:t}),u=new OverlaySplitter({splitterID:"ca_media_3_processor_overlay",frontID:"ca_media_3_processor_canvas",clipClass:"ca_overlay_split_clipping",clipVar:"--M3_OVERLAY_SPLIT_INSET"});document.getElementById("ca_media_3_selector_pad").addEventListener("click",e=>CA_media_o.M3_input_f(e.target.closest(".ca_media_3_pad_label"))),document.getElementById("ca_media_3_selector_console").addEventListener("mousemove",c,!1),M4_process()}catch(e){console.log(`ERROR DETECTED @M3_process: ${e}`)}},M4_process=()=>{try{document.getElementById("ca_media_4_huesvg");let e,t=CA_media_o.M3_scan_i.getHue_a(),_=CA_media_o.M3_scan_i.getHueCount_a(),i=CA_media_o.M3_scan_i.getCapacity_n(),s=t.length,a=[];for(let t=0;t<s;++t)e=_[t],a[t]=e?{frequency:e,hsl:`hsl(${t}, 100%, 50%)`}:null;const o=e=>{document.getElementById("ca_media_4_processor_trace_H_v").innerHTML=e,document.getElementById("ca_media_4_processor_trace_P_v").innerHTML=Number.parseFloat(_[e]/i*100).toFixed(2)};let n={svgId:"ca_media_4_huesvg",colors:a,maxfreq:CA_media_o.M3_scan_i.getHueCountMax,onHueChange:e=>{if(!t[e]||0===t[e].length)return;const[_,i]=CA_media_o.M3_scan_i.getSaturLumen_a(e),s=_.length,a=[],o=[];let n,l=0,r=0;for(let t=0;t<s;++t)(n=_[t])>l&&(l=n),a[t]=n?{frequency:n,hsl:`hsl(${e}, ${t}%, 50%)`}:null,(n=i[t])>r&&(r=n),o[t]=n?{frequency:n,hsl:`hsl(${e}, 100%, ${t}%)`}:null;DOMResetNode("ca_media_4_processor_satID"),new ColorBurst({svgId:"ca_media_4_processor_satID",colors:a,maxfreq:l}).draw(),DOMResetNode("ca_media_4_processor_lumID"),new ColorBurst({svgId:"ca_media_4_processor_lumID",colors:o,maxfreq:r}).draw()},onHueTrace:o};new ColorBurst(n).draw()}catch(e){console.log(`ERROR DETECTED @M4_hue_e: ${e}`)}},M_initImg=(e,t=!1)=>{try{const _=e.getAttribute("src");if(t){const e=document.getElementById("ca_gallery_img");e.setAttribute("src",_),e.setAttribute("data-src-width",t.width),e.setAttribute("data-src-height",t.height);const i=t.file_s.replace(/\.jpe?g/i,"");document.getElementById("ca_post_file_user").innerHTML=i,document.getElementById("ca_list_imgs_legend_file_user").innerHTML=i;const s=t.id_s;document.getElementById("ca_post_id_user").innerHTML=s,document.getElementById("ca_list_imgs_legend_id_user").innerHTML=s;const a=t.tag_s;document.getElementById("ca_post_tag_user").innerHTML=a,document.getElementById("ca_list_imgs_legend_tag_user").innerHTML=a;const o=document.getElementById("ca_user_collection_note_edit");o.value=t.note_s,document.getElementById("ca_user_collection_note_publish").innerHTML=marked(o.value)}document.querySelectorAll(".ca_media_processor_img").forEach(e=>{e.setAttribute("src",_),t&&(e.setAttribute("data-src-width",t.width),e.setAttribute("data-src-height",t.height))})}catch(e){console.log(`ERROR DETECTED @M_init: ${e}`)}},M_init=(e,t=!1)=>{M_initImg(e,t),M1_process(),M2_process(),M3_process()};window.location.pathname.includes(CA_media_userImgUrl_s)?userImgInit(M_init):(CA_media_o.M_img_e=document.getElementById("ca_gallery_img"),!1===CA_media_o.M_img_e.complete?CA_media_o.M_img_e.onload=(()=>M_init(CA_media_o.M_img_e)):M_init(CA_media_o.M_img_e));

